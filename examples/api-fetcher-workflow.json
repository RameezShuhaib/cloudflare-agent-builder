{
  "name": "API Data Fetcher and Transformer",
  "parameter_schema": {
    "type": "object",
    "properties": {
      "api_url": {
        "type": "string"
      },
      "api_key": {
        "type": "string"
      }
    },
    "required": ["api_url", "api_key"]
  },
  "nodes": [
    {
      "id": "fetch_data",
      "type": "http_request",
      "config": {
        "url": "{{parameters.api_url}}",
        "method": "GET",
        "headers": {
          "Authorization": "Bearer {{parameters.api_key}}",
          "Content-Type": "application/json"
        }
      },
      "dependencies": []
    },
    {
      "id": "transform_data",
      "type": "data_transformer",
      "config": {
        "template": {
          "users": "{{parent.fetch_data.data.users}}",
          "total_count": "{{parent.fetch_data.data.total}}",
          "processed_at": "{{parameters.current_time}}"
        }
      },
      "dependencies": ["fetch_data"]
    },
    {
      "id": "save_to_db",
      "type": "sql_query",
      "config": {
        "query": "INSERT INTO api_cache (data, fetched_at) VALUES ('{{parent.transform_data}}', datetime('now'))"
      },
      "dependencies": ["transform_data"]
    }
  ],
  "output_node": "save_to_db"
}
