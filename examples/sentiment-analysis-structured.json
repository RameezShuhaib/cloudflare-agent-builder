{
  "name": "Structured Sentiment Analysis with OpenAI SDK",
  "parameter_schema": {
    "type": "object",
    "properties": {
      "feedback_text": {
        "type": "string"
      }
    },
    "required": ["feedback_text"]
  },
  "nodes": [
    {
      "id": "analyze_sentiment",
      "type": "llm_enhancement",
      "config": {
        "model": "@cf/meta/llama-3.1-8b-instruct",
        "provider": "openai-sdk",
        "messages": [
          {
            "role": "system",
            "content": "You are a sentiment analysis expert. Analyze the given feedback and provide structured output."
          },
          {
            "role": "user",
            "content": "Analyze this feedback: {{parameters.feedback_text}}"
          }
        ],
        "response_format": {
          "type": "object",
          "properties": {
            "sentiment": {
              "type": "string",
              "enum": ["positive", "negative", "neutral"]
            },
            "confidence": {
              "type": "number",
              "minimum": 0,
              "maximum": 1
            },
            "key_phrases": {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            "categories": {
              "type": "array",
              "items": {
                "type": "string",
                "enum": ["product", "service", "price", "support", "quality"]
              }
            },
            "summary": {
              "type": "string",
              "maxLength": 200
            }
          },
          "required": ["sentiment", "confidence", "summary"]
        },
        "gateway": {
          "id": "my-gateway",
          "skipCache": false,
          "cacheTtl": 3600
        },
        "max_tokens": 500
      },
      "dependencies": []
    },
    {
      "id": "format_output",
      "type": "data_transformer",
      "config": {
        "template": {
          "input_text": "{{parameters.feedback_text}}",
          "analysis": "{{parent.analyze_sentiment}}",
          "processed_at": "{{parameters.current_timestamp}}"
        }
      },
      "dependencies": ["analyze_sentiment"]
    }
  ],
  "output_node": "format_output"
}
